# ğŸ” æ··åˆåŠ å¯†æ–¹æ¡ˆä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¶æ„è¯´æ˜

### åŠ å¯†æµç¨‹

```
1. GitHub Actions (æˆ–æœ¬åœ°) è¿è¡Œ
   â†“
2. ç”Ÿæˆéšæœº AES-256 å¯†é’¥
   â†“
3. ä½¿ç”¨ AES å¯†é’¥åŠ å¯†æ—¥è®°å†…å®¹ (å¿«é€Ÿ)
   â†“
4. ä½¿ç”¨ RSA å…¬é’¥åŠ å¯† AES å¯†é’¥ (å®‰å…¨)
   â†“
5. ä¿å­˜åˆ° public/diary-data.json
   {
     "encryptedData": "...",  // AES åŠ å¯†çš„æ—¥è®°
     "encryptedKey": "...",   // RSA åŠ å¯†çš„ AES å¯†é’¥
     "encryption": "hybrid"
   }
```

### è§£å¯†æµç¨‹

```
1. ç”¨æˆ·è®¿é—®ç½‘ç«™
   â†“
2. è¾“å…¥ RSA ç§é’¥ (æˆ–ä¸Šä¼  private.pem)
   â†“
3. ä½¿ç”¨ RSA ç§é’¥è§£å¯† AES å¯†é’¥
   â†“
4. ä½¿ç”¨ AES å¯†é’¥è§£å¯†æ—¥è®°å†…å®¹
   â†“
5. æ˜¾ç¤ºæ—¥è®°
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç”Ÿæˆ RSA å¯†é’¥å¯¹

```bash
npm run generate-keys
```

è¿™ä¼šåœ¨ `keys/` ç›®å½•ç”Ÿæˆ:
- `public.pem` - RSA å…¬é’¥ (å¯ä»¥æäº¤åˆ° GitHub)
- `private.pem` - RSA ç§é’¥ (â—è¯·å¦¥å–„ä¿ç®¡,ä¸è¦æäº¤)

### 2. æµ‹è¯•åŠ å¯†

```bash
npm run encrypt
```

### 3. é…ç½® GitHub Actions

å°† `keys/public.pem` æäº¤åˆ°ä»“åº“:

```bash
git add keys/public.pem
git commit -m "æ·»åŠ  RSA å…¬é’¥ç”¨äºè‡ªåŠ¨åŠ å¯†"
git push
```

### 4. è®¾ç½®è‡ªåŠ¨åŒ–å·¥ä½œæµ

ç°åœ¨ GitHub Actions å¯ä»¥:
1. è‡ªåŠ¨æ‹‰å–å­æ¨¡å—æ›´æ–°
2. ä½¿ç”¨å…¬é’¥åŠ å¯†æ—¥è®°
3. è‡ªåŠ¨éƒ¨ç½²

## ğŸ“ æ–‡ä»¶ç»“æ„

```
dairy/
â”œâ”€â”€ keys/
â”‚   â”œâ”€â”€ public.pem          # RSA å…¬é’¥ (æäº¤åˆ° GitHub)
â”‚   â””â”€â”€ private.pem         # RSA ç§é’¥ (æœ¬åœ°ä¿ç®¡,ä¸æäº¤)
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ generate-keys.js    # ç”Ÿæˆå¯†é’¥å¯¹
â”‚   â””â”€â”€ encrypt-diaries.js  # æ··åˆåŠ å¯†è„šæœ¬
â””â”€â”€ public/
    â””â”€â”€ diary-data.json     # åŠ å¯†åçš„æ•°æ®
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### ä¼˜åŠ¿

1. âœ… **è‡ªåŠ¨åŒ–éƒ¨ç½²**: GitHub Actions å¯ä»¥ç”¨å…¬é’¥è‡ªåŠ¨åŠ å¯†
2. âœ… **æ— éœ€ Secrets**: ä¸éœ€è¦åœ¨ GitHub å­˜å‚¨æ•æ„Ÿå¯†ç 
3. âœ… **é«˜å®‰å…¨æ€§**: RSA-2048 + AES-256 åŒé‡åŠ å¯†
4. âœ… **æ€§èƒ½ä¼˜ç§€**: å¤§é‡æ•°æ®ç”¨ AES å¿«é€ŸåŠ å¯†
5. âœ… **çµæ´»ç®¡ç†**: ç§é’¥ä¸¢å¤±å¯é‡æ–°ç”Ÿæˆå¯†é’¥å¯¹

### å®‰å…¨å»ºè®®

1. ğŸ” **å¤‡ä»½ç§é’¥**: å¤šå¤„å®‰å…¨å¤‡ä»½ `private.pem`
2. ğŸš« **ä¸è¦æäº¤ç§é’¥**: ç¡®ä¿ `.gitignore` åŒ…å« `keys/private.pem`
3. ğŸ“± **å¤šè®¾å¤‡åŒæ­¥**: å¯ä»¥å°†ç§é’¥å­˜åœ¨å¯†ç ç®¡ç†å™¨ä¸­
4. ğŸ”„ **å®šæœŸè½®æ¢**: å»ºè®®æ¯å¹´é‡æ–°ç”Ÿæˆå¯†é’¥å¯¹

## ğŸ› ï¸ æ•…éšœæ’é™¤

### é—®é¢˜: æœªæ‰¾åˆ° RSA å…¬é’¥

```
âš ï¸  è­¦å‘Š: æœªæ‰¾åˆ° RSA å…¬é’¥
é¢„æœŸè·¯å¾„: keys/public.pem
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
npm run generate-keys
```

### é—®é¢˜: GitHub Actions åŠ å¯†å¤±è´¥

**æ£€æŸ¥**:
1. `keys/public.pem` æ˜¯å¦å·²æäº¤?
2. æ–‡ä»¶æƒé™æ˜¯å¦æ­£ç¡®?

**ä¿®å¤**:
```bash
git add keys/public.pem
git commit -m "æ·»åŠ å…¬é’¥"
git push
```

### é—®é¢˜: å‰ç«¯è§£å¯†å¤±è´¥

**åŸå› **: éœ€è¦æ›´æ–°å‰ç«¯ä»£ç æ”¯æŒæ··åˆè§£å¯†

**æ£€æŸ¥**:
- ç™»å½•é¡µé¢æ˜¯å¦æ”¯æŒä¸Šä¼ /ç²˜è´´ RSA ç§é’¥?
- è§£å¯†é€»è¾‘æ˜¯å¦æ­£ç¡®å¤„ç† `encryption: 'hybrid'`?

## ğŸ”„ å·¥ä½œæµç¨‹

### æœ¬åœ°æ›´æ–°æ—¥è®°

```bash
# 1. æ›´æ–°æ—¥è®°
cd diary
# ç¼–è¾‘æ—¥è®°...
git add .
git commit -m "æ–°æ—¥è®°"
git push

# 2. è¿”å›ä¸»ä»“åº“
cd ..

# 3. è‡ªåŠ¨åŒ–è„šæœ¬
./update-and-deploy.sh
```

è¿™ä¸ªè„šæœ¬ä¼š:
1. âœ… æ‹‰å–å­æ¨¡å—æ›´æ–°
2. âœ… ç”¨ RSA å…¬é’¥åŠ å¯†
3. âœ… æäº¤å¹¶æ¨é€
4. âœ… è§¦å‘ GitHub Actions éƒ¨ç½²

### è¿œç¨‹æ›´æ–°æ—¥è®°(å…¶ä»–è®¾å¤‡)

```bash
# åœ¨å…¶ä»–è®¾å¤‡ç›´æ¥æ›´æ–° diary ä»“åº“
cd diary
# ç¼–è¾‘å¹¶æ¨é€...
git push
```

ç„¶å:
- **æ–¹æ¡ˆ A**: è§¦å‘ GitHub Actions (æ¨è)
  - å­ä»“åº“å¯ä»¥é…ç½® webhook è‡ªåŠ¨è§¦å‘ä¸»ä»“åº“
  - ä¸»ä»“åº“è‡ªåŠ¨æ‹‰å–ã€åŠ å¯†ã€éƒ¨ç½²

- **æ–¹æ¡ˆ B**: æ‰‹åŠ¨åŒæ­¥
  - åœ¨ä»»ä¸€è®¾å¤‡è¿è¡Œ `./update-and-deploy.sh`

## ğŸ“Š æ•°æ®æ ¼å¼

### æ—§æ ¼å¼ (v1.0 - å·²å¼ƒç”¨)

```json
{
  "data": "U2FsdGVkX1...",
  "timestamp": "2025-11-07T...",
  "count": 7
}
```

### æ–°æ ¼å¼ (v2.0 - æ··åˆåŠ å¯†)

```json
{
  "encryptedData": "U2FsdGVkX1...",  // AES åŠ å¯†çš„æ—¥è®°
  "encryptedKey": "aBcDeFg12...",    // RSA åŠ å¯†çš„ AES å¯†é’¥
  "timestamp": "2025-11-07T...",
  "count": 7,
  "encryption": "hybrid",
  "version": "2.0"
}
```

## ğŸ¯ ä¸‹ä¸€æ­¥

1. [ ] ç”Ÿæˆ RSA å¯†é’¥å¯¹
2. [ ] æµ‹è¯•æœ¬åœ°åŠ å¯†
3. [ ] æäº¤å…¬é’¥åˆ° GitHub
4. [ ] æ›´æ–°å‰ç«¯è§£å¯†é€»è¾‘
5. [ ] é…ç½® GitHub Actions è‡ªåŠ¨åŒ–
6. [ ] æµ‹è¯•å®Œæ•´æµç¨‹

## ğŸ“š ç›¸å…³å‘½ä»¤

```bash
# ç”Ÿæˆå¯†é’¥å¯¹
npm run generate-keys

# æ‰‹åŠ¨åŠ å¯†
npm run encrypt

# æœ¬åœ°å¼€å‘
npm run dev

# æ„å»ºéƒ¨ç½²
npm run build

# ä¸€é”®æ›´æ–°éƒ¨ç½²
./update-and-deploy.sh
```
